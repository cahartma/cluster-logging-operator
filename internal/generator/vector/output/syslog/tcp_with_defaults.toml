[transforms.example_json]
type = "remap"
inputs = ["application"]
source = '''
if exists(.message) { ._internal.message = .message }
. = merge(., parse_json!(string!(._internal.message))) ?? .
'''

[sinks.example]
type = "socket"
inputs = ["example_json"]
address = "logserver:514"
mode = "tcp"

[sinks.example.encoding]
codec = "syslog"
except_fields = ["_internal"]
rfc = "rfc5424"
facility = "user"
severity = "informational"